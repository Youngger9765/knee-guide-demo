<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>膝關節置換術與人工膝關節墊片選擇 - Medify</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen">
    <!-- Header Section with White Background - Logo Only -->
    <div class="bg-white border-b border-gray-200">
        <div class="flex justify-center py-6">
            <img src="./images/header-logo.png" alt="Logo" class="h-16 w-auto">
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-4xl mx-auto px-4 py-8">
        <!-- Article Header -->
        <div class="mb-8">
            <!-- Title -->
            <h1 class="text-4xl font-bold text-gray-900 mb-6">膝關節置換術與人工膝關節墊片選擇</h1>

            <!-- Author Info -->
            <div class="flex items-center gap-4 mb-6">
                <div class="w-16 h-16 rounded-full overflow-hidden flex-shrink-0">
                    <img src="./images/medify-team-avatar.png" alt="Medify Team" class="w-full h-full object-cover">
                </div>
                <div>
                    <p class="text-lg font-semibold text-gray-900">Medify Team · Medify 編輯團隊</p>
                    <p class="text-sm text-gray-600">· 2月 10日, 2026</p>
                </div>
            </div>

            <!-- Social Share Icons -->
            <div class="flex items-center gap-3 text-gray-700 mb-8">
                <div class="flex items-center gap-1.5">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                    </svg>
                    <span class="text-sm font-medium">2</span>
                </div>
                <button class="p-0.5">
                    <svg class="w-5 h-5 text-gray-800" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-9 14H8v-7h2v7zm1-8h-4V7h4v2zm5 8h-2v-4h-2v4h-2v-7h6v7z"/>
                    </svg>
                </button>
                <button class="p-0.5">
                    <svg class="w-5 h-5 text-gray-800" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/>
                    </svg>
                </button>
                <button class="p-0.5">
                    <svg class="w-5 h-5 text-gray-800" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5zm-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-2zm-3-4h8v2H8z"/>
                    </svg>
                </button>
            </div>
        </div>

    <!-- Table of Contents -->
    <div class="bg-gray-50 border-2 border-gray-200 rounded-lg p-6 mb-8">
        <h3 class="text-lg font-bold text-gray-900 mb-4">目錄</h3>
        <nav class="space-y-2">
            <a href="#introduction" class="block text-blue-600 hover:text-blue-800 hover:underline">簡介</a>
            <a href="#structure" class="block text-blue-600 hover:text-blue-800 hover:underline">膝關節之構造</a>
            <a href="#surgery" class="block text-blue-600 hover:text-blue-800 hover:underline">何謂全膝關節置換術</a>
            <a href="#indications" class="block text-blue-600 hover:text-blue-800 hover:underline">適應症</a>
            <a href="#selection" class="block text-blue-600 hover:text-blue-800 hover:underline">人工膝關節墊片該怎麼選擇？</a>
            <a href="#materials" class="block text-blue-600 hover:text-blue-800 hover:underline">人工膝關節墊片有哪些材質可選？</a>
        </nav>
    </div>

    <!-- Main Content -->
    <article class="prose prose-lg max-w-none">
        <!-- Introduction -->
        <section id="introduction" class="mb-12">
            <h2 class="text-3xl font-bold mb-4" style="color: #5177BA;">簡介</h2>
            <p class="text-gray-700 leading-relaxed">
                膝關節退化時，會產生疼痛、腫脹、變形、患肢無力，嚴重者會造成行走不便。當保守治療效果不佳時，醫師可能會建議進行全膝關節置換術，以改善生活品質。
            </p>
        </section>

        <!-- Knee Joint Structure -->
        <section id="structure" class="mb-12">
            <h2 class="text-3xl font-bold mb-4" style="color: #5177BA;">膝關節之構造</h2>
            <p class="text-gray-700 leading-relaxed mb-4">
                膝關節是人體最大的關節，由股骨（大腿骨）、脛骨（小腿骨）和髕骨（膝蓋骨）組成。關節表面覆蓋著光滑的軟骨，提供緩衝和潤滑作用，使關節能夠順暢活動。
            </p>
            <div class="my-6">
                <img src="./images/knee-structure.png" alt="膝關節構造圖" class="rounded-lg shadow-lg w-3/4 h-auto">
            </div>
        </section>

        <!-- What is Total Knee Replacement -->
        <section id="surgery" class="mb-12">
            <h2 class="text-3xl font-bold mb-4" style="color: #5177BA;">何謂全膝關節置換術</h2>
            <p class="text-gray-700 leading-relaxed mb-4">
                全膝關節置換術是將退化或受損的膝關節表面切除，以金屬和高分子聚乙烯材質的人工關節取代，恢復關節功能並減輕疼痛。手術通常需要1.5至2小時，住院約3至5天。
            </p>
            <div class="my-6">
                <img src="./images/knee-surgery.jpeg" alt="全膝關節置換術示意圖" class="rounded-lg shadow-lg w-3/4 h-auto">
            </div>
        </section>

        <!-- Indications -->
        <section id="indications" class="mb-12">
            <h2 class="text-3xl font-bold mb-4" style="color: #5177BA;">適應症</h2>
            <p class="text-gray-700 leading-relaxed mb-4">以下六種情況可能需要考慮進行全膝關節置換術：</p>
            <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
                <li>退化性關節炎</li>
                <li>類風濕性疾病</li>
                <li>外傷性關節炎</li>
                <li>痛風性關節炎</li>
                <li>骨壞死</li>
                <li>感染性關節炎</li>
            </ul>
        </section>

        <!-- Selection Guide -->
        <section id="selection" class="mb-12">
            <h2 class="text-3xl font-bold mb-4" style="color: #5177BA;">人工膝關節墊片該怎麼選擇？</h2>
            <p class="text-gray-700 leading-relaxed mb-6">
                人工膝關節墊片的選擇需考慮患者的年齡、活動量、身體狀況和經濟能力。以下提供一般性建議：
            </p>

            <div class="bg-blue-50 border-l-4 border-blue-500 p-6 mb-6">
                <h3 class="text-xl font-semibold text-gray-900 mb-3">活動量考量</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-white rounded-lg p-4">
                        <img src="./images/elderly-activity.png" alt="高齡患者活動" class="rounded-lg shadow-md w-full mb-3">
                        <p class="font-semibold text-gray-800">75 歲以上 + 緩和運動（散步、健行）</p>
                        <p class="text-sm text-gray-600">→ 健保給付材質即可滿足需求</p>
                    </div>
                    <div class="bg-white rounded-lg p-4">
                        <img src="./images/young-activity.png" alt="年輕患者運動" class="rounded-lg shadow-md w-full mb-3">
                        <p class="font-semibold text-gray-800">75 歲以下 + 激烈運動（跑步、打球）</p>
                        <p class="text-sm text-gray-600">→ 建議考慮自費升級高耐磨材質</p>
                    </div>
                </div>
            </div>

            <div class="my-6">
                <img src="./images/requirements-comparison.png" alt="需求比較表" class="rounded-lg shadow-lg w-full h-auto">
            </div>
        </section>

        <!-- Materials -->
        <section id="materials" class="mb-12">
            <h2 class="text-3xl font-bold mb-4" style="color: #5177BA;">人工膝關節墊片有哪些材質可選？</h2>
            <p class="text-gray-700 leading-relaxed mb-6">
                人工膝關節的墊片材質主要分為四種，耐磨性和價格各有不同：
            </p>

            <div class="my-6">
                <img src="./images/materials-comparison.png" alt="人工膝關節墊片材質比較" class="rounded-lg shadow-lg w-full h-auto">
            </div>

            <!-- Standard Material -->
            <div class="bg-white border-2 border-green-200 rounded-lg p-6 mb-6">
                <h3 class="text-2xl font-bold text-green-600 mb-4">健保標準聚乙烯</h3>
                <p class="text-gray-700 mb-4">健保給付的標準材質，適合高齡、活動量較低的患者。對大多數患者而言，健保材質已能滿足日常需求。</p>
                <div class="bg-gray-50 rounded p-4">
                    <p class="font-semibold text-gray-900 mb-2">價格：</p>
                    <ul class="space-y-2 text-sm text-gray-700">
                        <li>• 健保給付（墊片本身由健保全額給付）</li>
                        <li>• 病人僅需負擔：健保部分負擔 + 掛號費 + 住院相關費用</li>
                        <li>• 無需額外自付墊片費用</li>
                    </ul>
                    <p class="text-xs text-gray-600 mt-2">適合：高齡、活動量較低的患者</p>
                </div>
            </div>

            <!-- XPE Material -->
            <div class="bg-white border-2 border-gray-200 rounded-lg p-6 mb-6">
                <h3 class="text-2xl font-bold text-blue-600 mb-4">XPE 高耐磨聚乙烯</h3>
                <p class="text-gray-700 mb-4">交聯聚乙烯（Cross-linked Polyethylene），經過交聯處理提高耐磨性，適合一般活動量患者。</p>
                <div class="bg-gray-50 rounded p-4">
                    <p class="font-semibold text-gray-900 mb-2">產品選項與價格：</p>
                    <ul class="space-y-2 text-sm text-gray-700">
                        <li>• Zimmer NexGen：NT$ 59,850</li>
                        <li>• 聯合康熙系統：NT$ 61,750</li>
                        <li>• Biomet 牛津：NT$ 78,000</li>
                    </ul>
                </div>
            </div>

            <!-- E-XPE Material -->
            <div class="bg-white border-2 border-gray-200 rounded-lg p-6 mb-6">
                <h3 class="text-2xl font-bold text-purple-600 mb-4">E-XPE 抗氧化高耐磨聚乙烯</h3>
                <p class="text-gray-700 mb-4">強化交聯技術（Enhanced Cross-linked Polyethylene），具有更優異的耐磨性能和抗氧化能力，適合中等活動量患者。</p>
                <div class="bg-gray-50 rounded p-4">
                    <p class="font-semibold text-gray-900 mb-2">產品選項與價格：</p>
                    <ul class="space-y-2 text-sm text-gray-700">
                        <li>• 聯合康熙：NT$ 95,200</li>
                        <li>• Zimmer NexGen：NT$ 59,850</li>
                    </ul>
                </div>
            </div>

            <!-- Vitamin E Material -->
            <div class="bg-white border-2 border-amber-400 rounded-lg p-6 mb-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-2xl font-bold text-amber-600">Vivacit-E 維生素E交聯聚乙烯</h3>
                    <span class="bg-amber-500 text-white px-3 py-1 rounded-full text-sm font-bold">頂級推薦</span>
                </div>
                <p class="text-gray-700 mb-4">添加維生素 E 作為抗氧化劑（Vitamin E Stabilized Polyethylene），具有最優異的耐磨性和穩定性，減少氧化降解，適合年輕、活動量大的患者。</p>
                <div class="bg-gray-50 rounded p-4">
                    <p class="font-semibold text-gray-900 mb-2">產品選項與價格：</p>
                    <ul class="space-y-2 text-sm text-gray-700">
                        <li>• Zimmer PERSONA PS：NT$ 141,750</li>
                        <li>• Zimmer PERSONA MC：NT$ 159,000</li>
                    </ul>
                </div>
            </div>

            <!-- Selection Tips -->
            <div class="bg-green-50 border-l-4 border-green-500 p-6 mt-8">
                <h3 class="text-xl font-semibold text-green-900 mb-3">💡 選擇建議</h3>
                <p class="text-gray-700 leading-relaxed">
                    <strong>最重要的是與您的主治醫師充分溝通</strong>，根據您的實際需求、年齡、活動量要求，以及經濟考量，選擇最適合的人工膝關節材質。醫師會根據您的個別情況提供專業建議。
                </p>
            </div>
        </section>

        <!-- Conclusion -->
        <section class="mb-12 mt-12">
            <h2 class="text-3xl font-bold mb-6" style="color: #5177BA;">總結</h2>

            <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
                <p class="text-gray-700 leading-relaxed mb-4">
                    膝關節置換手術是一項成熟且安全的治療方式，能有效改善膝關節退化帶來的疼痛與行動不便。然而，每位患者的身體狀況、年齡、活動需求都不盡相同，因此沒有一種「最好」的選擇，只有「最適合您」的選擇。
                </p>

                <p class="text-gray-700 leading-relaxed mb-4">
                    無論是選擇健保給付的標準關節，還是自費升級更高階的材質，最重要的是與您的主治醫師充分溝通。醫師會根據您的：
                </p>

                <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4 mb-4">
                    <li>膝關節實際磨損情況</li>
                    <li>年齡與預期壽命</li>
                    <li>日常活動需求</li>
                    <li>經濟考量</li>
                    <li>整體健康狀態</li>
                </ul>

                <p class="text-gray-700 leading-relaxed mb-4">來為您提供專業建議。</p>

                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4">
                    <h3 class="font-semibold text-gray-900 mb-3">建議您：</h3>
                    <ul class="space-y-2 text-gray-700 text-sm">
                        <li>✓ 可以手機開啟此頁面，帶去門診參考</li>
                        <li>✓ 主動詢問醫師關於不同材質的優缺點與價格</li>
                        <li>✓ 了解義大醫院目前的庫存品項與實際費用</li>
                        <li>✓ 不要因為價格猶豫而拖延治療，及早手術效果更好</li>
                        <li>✓ 與家人一起討論，做出最適合的決定</li>
                    </ul>
                </div>

                <div class="bg-amber-50 border border-amber-300 rounded-lg p-4 mb-4">
                    <p class="text-gray-800 leading-relaxed">
                        <strong>記住：</strong>健保標準關節已經能滿足大多數患者的需求，自費升級是為了追求更長的使用壽命或更好的活動表現，但並非必要。最重要的是選擇一位經驗豐富的醫師、做好術後復健，這些因素對手術成功的影響，往往比關節材質本身更為關鍵。
                    </p>
                </div>

                <p class="text-center text-lg font-semibold text-blue-700 mt-6">
                    祝您早日恢復健康，重拾行動自如的生活！
                </p>
            </div>
        </section>

    </article>
</div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-300 py-6 mt-12">
        <div class="max-w-4xl mx-auto px-4 text-center">
            <p class="text-sm">© Copyright 2026 奧美特科技股份有限公司 All Rights Reserved</p>
        </div>
    </footer>
    </div>

    <!-- Chatbot Widget -->
    <div id="chatbot-container" class="fixed bottom-6 right-6 z-50">
        <!-- Chatbot Button -->
        <button id="chatbot-toggle" class="w-20 h-20 rounded-full shadow-2xl hover:shadow-3xl transition-all duration-300 hover:scale-110">
            <img src="./images/chatbot-icon.png" alt="Chatbot" class="w-full h-full rounded-full">
        </button>

        <!-- Chatbot Panel -->
        <div id="chatbot-panel" class="hidden absolute bottom-24 right-0 w-96 h-[600px] bg-white rounded-2xl shadow-2xl flex flex-col overflow-hidden">
            <!-- Header -->
            <div class="bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/>
                        </svg>
                    </div>
                    <div>
                        <div class="font-semibold">膝關節諮詢助理</div>
                        <div class="text-xs text-blue-100">為您解答人工膝關節相關問題</div>
                    </div>
                </div>
                <button id="chatbot-close" class="hover:bg-blue-800 rounded-full p-1 transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>

            <!-- Messages Container -->
            <div id="chat-messages" class="flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50">
                <!-- Welcome Message -->
                <div class="flex gap-2">
                    <div class="w-8 h-8 bg-blue-600 rounded-full flex-shrink-0 flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <div class="bg-white rounded-lg p-3 shadow-sm">
                            <p class="text-sm text-gray-800">您好！我是膝關節諮詢助理。以下是常見問題，點擊即可查看解答：</p>
                        </div>
                    </div>
                </div>

                <!-- Predefined Questions -->
                <div class="grid grid-cols-1 gap-2 mt-3">
                    <button class="predefined-question text-left text-sm bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg p-3 transition" data-question="什麼情況需要膝關節置換手術？">
                        什麼情況需要膝關節置換手術？
                    </button>
                    <button class="predefined-question text-left text-sm bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg p-3 transition" data-question="人工膝關節材質有哪些？">
                        人工膝關節材質有哪些？
                    </button>
                    <button class="predefined-question text-left text-sm bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg p-3 transition" data-question="手術要住院幾天？">
                        手術要住院幾天？
                    </button>
                    <button class="predefined-question text-left text-sm bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg p-3 transition" data-question="如何選擇適合的人工膝關節？">
                        如何選擇適合的人工膝關節？
                    </button>
                    <button class="predefined-question text-left text-sm bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg p-3 transition" data-question="維生素E材質有什麼優點？">
                        維生素E材質有什麼優點？
                    </button>
                </div>
            </div>

            <!-- Input Area -->
            <div class="p-4 bg-white border-t border-gray-200">
                <div class="flex gap-2">
                    <input type="text" id="chat-input" placeholder="輸入您的問題..." class="flex-1 px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                    <button id="chat-send" class="bg-blue-600 hover:bg-blue-700 text-white rounded-full p-2 transition">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Chatbot Styles -->
    <style>
        /* Markdown Styling */
        .bot-message strong {
            font-weight: 600;
            color: #1F2937;
        }
        .bot-message ul {
            margin: 8px 0;
            padding-left: 20px;
        }
        .bot-message li {
            margin: 4px 0;
        }
        .bot-message p {
            margin: 8px 0;
        }

        /* Typing Indicator Animation */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 12px 16px;
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #9CA3AF;
            animation: typing 1.4s infinite;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.7;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }
    </style>

    <!-- Chatbot JavaScript -->
    <script>
        // Enhanced Knowledge Base - RAG-like system with ~50 Q&A pairs
        const knowledgeBase = [
            // 價格相關 (10 questions)
            {
                id: 1,
                question: "人工膝關節手術要多少錢？",
                keywords: ["價格", "价格", "費用", "费用", "多少錢", "多少钱", "貴", "贵", "便宜", "花費", "花费", "成本", "價位", "价位", "收費", "收费", "要花", "price", "cost", "expensive", "cheap", "how much", "fee"],
                weight: 1.0,
                answer: "人工膝關節墊片的費用依材質而有不同：\n\n• **健保標準聚乙烯**：健保給付（墊片本身由健保全額給付，病人僅需負擔健保部分負擔、掛號費與住院相關費用，無需額外自付墊片費用）\n• **XPE 高耐磨聚乙烯**：約 NT$ 59,850 – 78,000\n• **E-XPE 抗氧化高耐磨聚乙烯**：約 NT$ 59,850 – 95,200\n• **Vivacit-E 維生素 E 交聯聚乙烯**：約 NT$ 141,750 – 159,000（頂級推薦，適合年輕、活動量大的患者）\n\n健保有給付標準關節，自費升級部分需額外負擔。建議與醫師討論您的需求和預算。"
            },
            {
                id: 2,
                question: "健保有給付嗎？",
                keywords: ["健保", "健保", "給付", "给付", "補助", "补助", "保險", "保险", "自費", "自费", "全額", "全额", "部分負擔", "部分负担", "insurance", "coverage", "subsidy", "out of pocket"],
                weight: 1.0,
                answer: "健保有給付標準的人工膝關節，但如果您想選擇更高階的材質（如 E-XPE 或維生素E），就需要自費補差額。\n\n• 健保給付：基本款關節\n• 自費升級：NT$ 5-16 萬不等\n\n75歲以上從事緩和運動的患者，健保給付材質通常就能滿足需求。"
            },
            {
                id: 3,
                question: "最貴的跟最便宜的差在哪？",
                keywords: ["差別", "差異", "不同", "區別", "比較", "對比"],
                weight: 0.9,
                answer: "主要差異在於**耐磨性**和**使用壽命**：\n\n**基本款（健保）：**\n• 適合一般活動量\n• 標準使用壽命\n\n**高階款（自費）：**\n• 更好的耐磨性\n• 延長使用壽命\n• 抗氧化能力更強\n• 適合年輕、活動量大的患者\n\n但記住：醫師經驗和術後復健往往比材質更重要！"
            },
            {
                id: 4,
                question: "有分期付款嗎？",
                keywords: ["分期", "付款", "貸款", "分批", "月付"],
                weight: 0.8,
                answer: "關於付款方式的詳細資訊，建議您直接向義大醫院櫃檯或財務部門諮詢。許多醫院都有提供分期付款或醫療貸款的方案。"
            },

            // 手術相關 (10 questions)
            {
                id: 5,
                question: "手術要多久時間？",
                keywords: ["手術時間", "手术时间", "多久", "幾小時", "几小时", "時長", "时长", "surgery time", "how long", "duration", "hours"],
                weight: 1.0,
                answer: "全膝關節置換術通常需要：\n\n• **手術時間**：1.5 至 2 小時\n• **住院天數**：約 3 至 5 天\n\n實際時間會依個人狀況和手術複雜度而有所調整。"
            },
            {
                id: 6,
                question: "手術會很痛嗎？",
                keywords: ["痛", "疼痛", "痛苦", "不舒服", "麻醉", "麻醉", "pain", "painful", "hurt", "anesthesia", "uncomfortable"],
                weight: 1.0,
                answer: "手術過程中會施行麻醉，所以不會感到疼痛。術後會有疼痛感，但醫院會提供完善的疼痛控制（止痛藥、止痛針等）。\n\n現代疼痛管理技術已經相當進步，大多數患者都能在可接受範圍內度過恢復期。"
            },
            {
                id: 7,
                question: "手術有風險嗎？",
                keywords: ["風險", "危險", "安全", "併發症", "失敗", "問題"],
                weight: 1.0,
                answer: "膝關節置換手術是一項**成熟且安全**的治療方式，但任何手術都有風險。常見風險包括：\n\n• 感染\n• 血栓\n• 出血\n• 麻醉反應\n\n然而，這些風險的發生率都很低。選擇經驗豐富的醫師、做好術前評估，能大幅降低風險。"
            },
            {
                id: 8,
                question: "需要住院幾天？",
                keywords: ["住院", "幾天", "多久", "出院"],
                weight: 1.0,
                answer: "一般而言，全膝關節置換術後需住院 **3 至 5 天**。\n\n實際住院時間會依據：\n• 個人恢復狀況\n• 是否有併發症\n• 復健進度\n• 醫師評估\n\n出院後仍需持續門診追蹤和復健。"
            },
            {
                id: 9,
                question: "術後要復健多久？",
                keywords: ["復健", "恢復", "康復", "物理治療"],
                weight: 1.0,
                answer: "術後復健非常重要！一般建議：\n\n• **密集復健期**：術後 2-3 個月\n• **持續復健期**：3-6 個月\n• **維持期**：終身維持適度運動\n\n做好復健的患者，手術成功率和滿意度都會顯著提高。這比墊片材質選擇更為關鍵！"
            },
            {
                id: 10,
                question: "手術後可以正常走路嗎？",
                keywords: ["走路", "行動", "活動", "正常", "日常生活"],
                weight: 0.9,
                answer: "是的！膝關節置換手術的主要目標就是讓您恢復正常行走能力。\n\n大多數患者在術後 3-6 個月都能：\n• 正常走路\n• 上下樓梯\n• 從事日常活動\n• 進行緩和運動（散步、健行）\n\n許多患者表示，術後的行動能力比手術前好很多！"
            },

            // 適應症相關 (8 questions)
            {
                id: 11,
                question: "什麼情況需要換膝關節？",
                keywords: ["適應症", "适应症", "情況", "情况", "需要", "什麼時候", "什么时候", "條件", "条件", "症狀", "症状", "indication", "condition", "when", "need", "symptom"],
                weight: 1.0,
                answer: "以下六種情況可能需要考慮膝關節置換術：\n\n1. **退化性關節炎**\n2. **類風濕性疾病**\n3. **外傷性關節炎**\n4. **痛風性關節炎**\n5. **骨壞死**\n6. **感染性關節炎**\n\n當保守治療（藥物、復健）效果不佳，且嚴重影響生活品質時，醫師會建議手術。"
            },
            {
                id: 12,
                question: "退化性關節炎一定要開刀嗎？",
                keywords: ["退化", "關節炎", "一定要", "必須", "不開刀"],
                weight: 0.9,
                answer: "不一定！退化性關節炎的治療是階段性的：\n\n**保守治療**（優先考慮）：\n• 藥物治療\n• 物理治療\n• 減重\n• 輔具使用\n\n**手術治療**（保守治療無效時）：\n• 關節鏡手術\n• 截骨矯正術\n• 全膝關節置換術\n\n只有當保守治療效果不佳，且嚴重影響生活時，才會建議手術。"
            },
            {
                id: 13,
                question: "膝蓋痛就要開刀嗎？",
                keywords: ["膝蓋痛", "疼痛", "痛"],
                weight: 0.8,
                answer: "不一定！膝蓋痛有很多原因，不是所有情況都需要開刀。\n\n建議先：\n1. 就醫檢查，找出疼痛原因\n2. 嘗試保守治療（藥物、復健）\n3. 評估疼痛程度和對生活的影響\n\n只有當疼痛嚴重、保守治療無效、嚴重影響生活品質時，才會考慮手術。"
            },
            {
                id: 14,
                question: "X光檢查說我磨損很嚴重，一定要換嗎？",
                keywords: ["磨損", "嚴重", "X光", "檢查", "報告"],
                weight: 0.9,
                answer: "X光磨損程度只是評估的一部分，更重要的是**您的症狀**和**生活品質**。\n\n即使 X 光顯示嚴重磨損，如果：\n• 疼痛可接受\n• 不影響日常生活\n• 保守治療有效\n\n就可以繼續觀察，不一定要立即手術。\n\n反之，如果症狀嚴重影響生活，就應該考慮手術。請與醫師充分討論。"
            },

            // 材質選擇相關 (12 questions)
            {
                id: 15,
                question: "有哪些材質可以選？",
                keywords: ["材質", "材质", "種類", "种类", "選項", "选项", "有哪些", "類型", "类型", "material", "type", "option", "choice", "kind"],
                weight: 1.0,
                answer: "人工膝關節墊片主要有四種材質：\n\n1. **健保標準聚乙烯**\n   • 價格：健保給付（墊片本身由健保全額給付，病人僅需負擔健保部分負擔、掛號費與住院相關費用）\n   • 適合：高齡、活動量較低的患者\n\n2. **XPE 高耐磨聚乙烯**\n   • 價格：約 NT$ 59,850 – 78,000\n   • 適合：一般活動量患者\n\n3. **E-XPE 抗氧化高耐磨聚乙烯**\n   • 價格：約 NT$ 59,850 – 95,200\n   • 適合：中等活動量患者\n\n4. **Vivacit-E 維生素 E 交聯聚乙烯**\n   • 價格：約 NT$ 141,750 – 159,000\n   • 頂級推薦，適合年輕、活動量大的患者"
            },
            {
                id: 16,
                question: "我應該選哪一種材質？",
                keywords: ["選擇", "如何選", "怎麼選", "哪一種", "推薦", "建議"],
                weight: 1.0,
                answer: "選擇墊片材質需考慮以下因素：\n\n**年齡與活動量**：\n• 75歲以上 + 緩和運動 → 健保給付即可\n• 75歲以下 + 激烈運動 → 建議自費升級\n\n**其他考量**：\n• 經濟能力\n• 預期使用年限\n• 個人需求\n\n最重要的是**與主治醫師充分溝通**，醫師會根據您的個別情況提供專業建議。"
            },
            {
                id: 17,
                question: "維生素E材質有什麼好處？",
                keywords: ["維生素E", "维生素E", "Vivacit", "頂級", "顶级", "最好的", "最好", "優點", "优点", "vitamin E", "best", "advantage", "benefit", "premium"],
                weight: 1.0,
                answer: "**Vivacit-E 維生素E交聯聚乙烯**是目前頂級推薦的材質：\n\n**主要優點**：\n• 添加維生素 E 作為抗氧化劑\n• 最優異的耐磨性和穩定性\n• 減少氧化降解\n• 使用壽命更長\n\n**適合族群**：\n• 年輕患者\n• 活動量大\n• 追求長期使用\n\n**價格**：NT$ 141,750 - 159,000"
            },
            {
                id: 18,
                question: "XPE 和 E-XPE 差在哪？",
                keywords: ["XPE", "E-XPE", "差別", "不同"],
                weight: 0.9,
                answer: "**XPE（交聯聚乙烯）**：\n• 基本款高耐磨材質\n• 適合一般活動量\n• 價格較親民\n\n**E-XPE（強化交聯聚乙烯）**：\n• 進階版\n• 更優異的耐磨性能\n• 額外的抗氧化能力\n• 適合中等活動量患者\n\nE-XPE 可以看作是 XPE 的升級版，耐用度和穩定性都更好。"
            },
            {
                id: 19,
                question: "材質真的那麼重要嗎？",
                keywords: ["重要", "關鍵", "影響", "差異大"],
                weight: 0.9,
                answer: "墊片材質重要，但**不是最重要的**！\n\n**更重要的因素**：\n1. **醫師經驗**：技術好的醫師比墊片材質更關鍵\n2. **術後復健**：認真復健的效果遠超墊片材質差異\n3. **個人保養**：體重控制、適度運動\n\n健保標準墊片已能滿足大多數患者需求。自費升級墊片是為了追求更長使用壽命，但並非必要。\n\n選擇經驗豐富的醫師、做好術後復健，才是手術成功的關鍵！"
            },
            {
                id: 20,
                question: "便宜的材質會不會很快就壞掉？",
                keywords: ["壞掉", "耐用", "壽命", "使用年限", "多久"],
                weight: 0.8,
                answer: "不會！健保給付的標準墊片已經是經過嚴格認證的醫材，品質有保障。\n\n**一般使用壽命**：\n• 標準墊片材質：15-20 年\n• 高階墊片材質：20-25 年以上\n\n**實際壽命取決於**：\n• 使用方式（避免過度負荷）\n• 體重控制\n• 術後復健品質\n• 定期追蹤保養\n\n75歲以上患者選擇健保墊片材質通常就很夠用了！"
            },

            // 年齡相關 (6 questions)
            {
                id: 21,
                question: "幾歲可以做這個手術？",
                keywords: ["年齡", "幾歲", "歲數", "太老", "太年輕"],
                weight: 0.9,
                answer: "膝關節置換手術**沒有嚴格的年齡限制**，主要看：\n\n• 症狀嚴重程度\n• 整體健康狀況\n• 生活品質影響\n\n**年齡考量**：\n• **年輕患者**：考慮使用壽命，可能需要二次手術\n• **高齡患者**：評估麻醉風險和恢復能力\n\n75歲以上和75歲以下，在墊片材質選擇上會有不同建議。請與醫師討論您的個人狀況。"
            },
            {
                id: 22,
                question: "我才50歲，會不會太年輕？",
                keywords: ["50", "年輕", "早", "太快"],
                weight: 0.8,
                answer: "50歲不算太年輕！如果症狀嚴重影響生活，不應該因為年齡而拖延治療。\n\n**年輕患者的考量**：\n• 建議選擇高階墊片材質（維生素E）\n• 預期使用壽命更長\n• 可能避免二次手術\n• 術後活動需求較高\n\n及早手術、恢復正常生活，比忍受疼痛更重要。重點是選對墊片材質和做好復健！"
            },
            {
                id: 23,
                question: "80歲了還能開刀嗎？",
                keywords: ["80", "高齡", "老", "年紀大"],
                weight: 0.8,
                answer: "可以！只要整體健康狀況允許。\n\n**高齡患者評估重點**：\n• 心肺功能\n• 麻醉風險\n• 慢性病控制\n• 預期恢復能力\n\n許多80歲以上患者成功接受手術，術後生活品質大幅提升。年齡不是絕對限制，重點是**整體健康評估**。\n\n材質方面，健保給付就很夠用了，不需要特別自費升級。"
            },

            // 活動與運動 (6 questions)
            {
                id: 24,
                question: "手術後可以運動嗎？",
                keywords: ["運動", "活動", "跑步", "爬山", "打球"],
                weight: 1.0,
                answer: "可以！但要選擇適合的運動類型。\n\n**建議的運動**：\n• 散步\n• 健行\n• 游泳\n• 騎腳踏車\n• 高爾夫球\n\n**應避免的運動**：\n• 跑步（長距離）\n• 跳躍類運動\n• 需要急轉急停的球類\n• 重量訓練（過重）\n\n適度運動能延長人工關節壽命，過度激烈則會加速磨損。請遵循醫師和復健師的建議。"
            },
            {
                id: 25,
                question: "我很愛爬山，手術後還能爬嗎？",
                keywords: ["爬山", "登山", "健行"],
                weight: 0.9,
                answer: "可以爬山！但建議：\n\n**術後初期**：\n• 等待充分恢復（至少3-6個月）\n• 先從平地健行開始\n\n**長期建議**：\n• 選擇坡度較緩的步道\n• 使用登山杖減輕膝蓋負擔\n• 控制爬山頻率和強度\n• 下山時特別小心（對膝蓋壓力較大）\n\n如果您是活躍的登山者，建議選擇較高階的材質，並與醫師討論您的活動需求。"
            },
            {
                id: 26,
                question: "平常只是散步買菜，需要用好的材質嗎？",
                keywords: ["散步", "買菜", "日常", "輕量", "簡單"],
                weight: 0.9,
                answer: "如果您的活動主要是散步、買菜等日常活動，**健保給付的標準墊片就很夠用了**！\n\n特別是75歲以上的患者，標準墊片材質已能滿足需求，不需要額外花錢升級。\n\n把預算省下來，或用在其他更需要的地方，例如：\n• 術後復健\n• 營養補充\n• 輔具購買\n\n重點是做好復健和定期追蹤，這比墊片材質選擇更重要！"
            },

            // 術後照護 (5 questions)
            {
                id: 27,
                question: "出院後要注意什麼？",
                keywords: ["出院", "注意", "照護", "居家"],
                weight: 0.9,
                answer: "出院後的居家照護很重要：\n\n**日常照護**：\n• 按時服藥\n• 傷口保持乾燥\n• 避免跌倒（移除障礙物）\n• 使用輔具（拐杖、助行器）\n\n**復健**：\n• 每天按時做復健運動\n• 定期回診追蹤\n• 記錄恢復進度\n\n**警訊**（立即就醫）：\n• 傷口紅腫、化膿\n• 持續高燒\n• 劇烈疼痛\n• 小腿腫脹（血栓風險）"
            },
            {
                id: 28,
                question: "需要家人照顧嗎？",
                keywords: ["照顧", "家人", "陪伴", "看護"],
                weight: 0.8,
                answer: "術後初期（1-2週）建議有家人協助：\n\n**需要協助的事項**：\n• 協助行動（上廁所、洗澡）\n• 準備餐點\n• 協助復健運動\n• 陪同回診\n\n**是否需要請看護**：\n• 視個人恢復狀況\n• 家庭支持系統\n• 經濟考量\n\n大多數患者不需要長期看護，但術後1-2週有人協助會比較安心。"
            },

            // 其他實用問題 (8 questions)
            {
                id: 29,
                question: "義大醫院有這些材質嗎？",
                keywords: ["義大", "醫院", "有沒有", "庫存", "品項"],
                weight: 0.9,
                answer: "關於義大醫院目前的材質庫存和可選品項，建議您：\n\n1. 直接詢問門診醫師\n2. 聯繫醫院客服或骨科部門\n3. 帶這份資料到門診參考討論\n\n不同醫院的進貨品項可能不同，直接確認最準確！"
            },
            {
                id: 30,
                question: "可以指定廠牌嗎？",
                keywords: ["廠牌", "品牌", "指定", "Zimmer", "Biomet"],
                weight: 0.8,
                answer: "通常可以與醫師討論您的偏好，但也要考慮：\n\n• 醫師對該廠牌的使用經驗\n• 醫院的進貨品項\n• 價格差異\n\n**常見品牌**：\n• Zimmer NexGen\n• Zimmer PERSONA\n• Biomet 牛津\n• 聯合康熙系統\n\n重點是醫師的使用經驗，而非品牌本身。經驗豐富的醫師，用任何品牌都能有好效果！"
            },
            {
                id: 31,
                question: "兩隻膝蓋都要換嗎？",
                keywords: ["兩隻", "雙側", "兩邊", "都要", "一起"],
                weight: 0.9,
                answer: "不一定！取決於：\n\n• 兩側膝蓋的磨損程度\n• 症狀嚴重度\n• 整體健康狀況\n\n**同時手術**：\n• 一次麻醉解決\n• 恢復期集中\n• 但風險稍高\n\n**分次手術**：\n• 風險較低\n• 一側先恢復可協助另一側\n• 但要經歷兩次手術\n\n請與醫師討論，評估您的狀況後決定。"
            },
            {
                id: 32,
                question: "可以先預約諮詢嗎？",
                keywords: ["預約", "諮詢", "門診", "掛號"],
                weight: 0.8,
                answer: "當然可以！建議您：\n\n1. **先掛骨科門診**進行評估\n2. 帶著這份資料去討論\n3. 準備問題清單\n4. 可以帶家人一起聽\n\n諮詢時可以問：\n• 是否需要手術\n• 適合的材質\n• 費用明細\n• 手術時程\n• 醫師經驗\n\n充分了解後再做決定，不要急著當天就決定！"
            },
            {
                id: 33,
                question: "手術後多久可以開車？",
                keywords: ["開車", "駕駛", "騎車"],
                weight: 0.7,
                answer: "一般建議：\n\n• **手動排檔**：術後 6-8 週\n• **自動排檔**：術後 4-6 週\n• **騎機車**：術後 8-12 週\n\n但實際時間要看：\n• 哪一側膝蓋（右側影響煞車）\n• 恢復進度\n• 醫師評估\n\n安全第一，不要勉強！初期可以請家人接送或搭乘大眾運輸工具。"
            },
            {
                id: 34,
                question: "會需要拐杖嗎？",
                keywords: ["拐杖", "助行器", "輔具", "柺杖"],
                weight: 0.8,
                answer: "是的，術後初期會需要輔具協助：\n\n**時程**：\n• 術後 1-2 週：助行器或兩支拐杖\n• 術後 2-4 週：單支拐杖\n• 術後 4-6 週：逐漸不用輔具\n\n**建議**：\n• 術前就先準備好\n• 可向醫院租借或購買\n• 學會正確使用方式\n\n使用輔具能降低跌倒風險，加速恢復，不要急著不用！"
            },
            {
                id: 35,
                question: "手術前需要準備什麼？",
                keywords: ["準備", "術前", "注意事項"],
                weight: 0.8,
                answer: "術前準備事項：\n\n**身體準備**：\n• 控制慢性病（血糖、血壓）\n• 減重（若體重過重）\n• 戒菸\n• 加強肌力訓練\n\n**居家準備**：\n• 購買/租借輔具\n• 調整家中環境（防跌倒）\n• 準備方便穿脫的衣物\n\n**心理準備**：\n• 了解手術流程\n• 學習復健運動\n• 安排照護人力\n\n充分準備能讓術後恢復更順利！"
            }
        ];

        const fallbackMessage = "很抱歉，您的問題超出本諮詢系統的服務範圍。關於人工膝關節置換術的具體醫療建議，建議您親自到診間與專業醫師或護理師諮詢，以獲得最準確、最適合您個人狀況的專業評估與建議。";

        // Keyword matching algorithm with scoring
        function findBestMatch(userQuestion) {
            const normalizedQuestion = userQuestion.toLowerCase().trim();
            let bestMatch = null;
            let highestScore = 0;

            knowledgeBase.forEach(entry => {
                let score = 0;
                let matchCount = 0;

                // Check each keyword
                entry.keywords.forEach(keyword => {
                    if (normalizedQuestion.includes(keyword.toLowerCase())) {
                        matchCount++;
                        // Weight the score
                        score += entry.weight;
                    }
                });

                // Bonus for multiple keyword matches
                if (matchCount > 1) {
                    score *= (1 + matchCount * 0.2);
                }

                // Update best match
                if (score > highestScore) {
                    highestScore = score;
                    bestMatch = entry;
                }
            });

            // Return match only if score is above threshold
            const threshold = 0.3;
            if (highestScore >= threshold && bestMatch) {
                return bestMatch.answer;
            }

            return fallbackMessage;
        }

        // DOM Elements
        const chatbotToggle = document.getElementById('chatbot-toggle');
        const chatbotPanel = document.getElementById('chatbot-panel');
        const chatbotClose = document.getElementById('chatbot-close');
        const chatMessages = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        const chatSend = document.getElementById('chat-send');
        const predefinedQuestions = document.querySelectorAll('.predefined-question');

        // Toggle Chatbot
        chatbotToggle.addEventListener('click', () => {
            chatbotPanel.classList.toggle('hidden');
        });

        chatbotClose.addEventListener('click', () => {
            chatbotPanel.classList.add('hidden');
        });

        // Add User Message
        function addUserMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex gap-2 justify-end';
            messageDiv.innerHTML = `
                <div class="bg-blue-600 text-white rounded-lg p-3 shadow-sm max-w-[80%]">
                    <p class="text-sm">${text}</p>
                </div>
                <div class="w-8 h-8 bg-gray-300 rounded-full flex-shrink-0 flex items-center justify-center">
                    <svg class="w-5 h-5 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Add Typing Indicator
        function addTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'flex gap-2';
            typingDiv.id = 'typing-indicator';
            typingDiv.innerHTML = `
                <div class="w-8 h-8 bg-blue-600 rounded-full flex-shrink-0 flex items-center justify-center">
                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
                    </svg>
                </div>
                <div class="flex-1">
                    <div class="bg-white rounded-lg shadow-sm">
                        <div class="typing-indicator">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Remove Typing Indicator
        function removeTypingIndicator() {
            const typingDiv = document.getElementById('typing-indicator');
            if (typingDiv) {
                typingDiv.remove();
            }
        }

        // Simple Markdown to HTML converter
        function parseMarkdown(text) {
            // Convert **bold** to <strong>
            text = text.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');

            // Convert bullet points (• or -) at start of line to <li>
            const lines = text.split('\n');
            let html = '';
            let inList = false;

            lines.forEach((line, index) => {
                const trimmedLine = line.trim();

                // Check if line is a bullet point
                if (trimmedLine.match(/^[•\-]\s+(.+)$/)) {
                    const content = trimmedLine.replace(/^[•\-]\s+/, '');
                    if (!inList) {
                        html += '<ul>';
                        inList = true;
                    }
                    html += `<li>${content}</li>`;
                } else {
                    if (inList) {
                        html += '</ul>';
                        inList = false;
                    }
                    if (trimmedLine) {
                        html += `<p>${trimmedLine}</p>`;
                    }
                }
            });

            if (inList) {
                html += '</ul>';
            }

            return html;
        }

        // Add Bot Message
        function addBotMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex gap-2';
            const htmlContent = parseMarkdown(text);
            messageDiv.innerHTML = `
                <div class="w-8 h-8 bg-blue-600 rounded-full flex-shrink-0 flex items-center justify-center">
                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
                    </svg>
                </div>
                <div class="flex-1">
                    <div class="bg-white rounded-lg p-3 shadow-sm bot-message">
                        <div class="text-sm text-gray-800">${htmlContent}</div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }


        // Handle User Input
        function handleUserInput() {
            const question = chatInput.value.trim();
            if (!question) return;

            addUserMessage(question);
            chatInput.value = '';

            // Show typing indicator
            addTypingIndicator();

            // Simulate thinking delay (3-4 seconds)
            const thinkingTime = 3000 + Math.random() * 1000;

            setTimeout(() => {
                removeTypingIndicator();
                const answer = findBestMatch(question);
                addBotMessage(answer);
            }, thinkingTime);
        }

        // Predefined Questions
        predefinedQuestions.forEach(btn => {
            btn.addEventListener('click', () => {
                const question = btn.dataset.question;
                addUserMessage(question);

                // Show typing indicator
                addTypingIndicator();

                // Simulate thinking delay (3-4 seconds)
                const thinkingTime = 3000 + Math.random() * 1000;

                setTimeout(() => {
                    removeTypingIndicator();
                    const answer = findBestMatch(question);
                    addBotMessage(answer);
                }, thinkingTime);
            });
        });

        // Send Button
        chatSend.addEventListener('click', handleUserInput);

        // Enter Key
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleUserInput();
            }
        });
    </script>
</body>
</html>
